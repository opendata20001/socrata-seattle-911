angular.module("seahawk-crime",["seahawk.crime-map"]),angular.module("seahawk.crime-map",["seahawk.crimeData"]).directive("crimeMap",["crimeData",function(e){return{scope:{},link:function(t,a){L.Icon.Default.imagePath="assets/images";var r=L.map(a[0],{scrollWheelZoom:!1,maxBounds:[[47,-122.2],[48,-122.5]],minZoom:13}).setView([47.595,-122.3321654],14);L.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}).addTo(r);var o=L.icon({iconUrl:"assets/images/seahawks.png",iconSize:[140,62]});L.marker([47.595,-122.3321654],{icon:o}).addTo(r);var n=L.Control.extend({options:{position:"topright"},onAdd:function(e){var t=L.DomUtil.create("div","crime-sidebar");return $(t).html($("#sidebar-tpl").html()),t}});r.addControl(new n);var i=_.template($("#popup-tpl").text());e().then(function(e){var t=L.markerClusterGroup();e.features.forEach(function(e){var a=moment(e.properties.event_clearance_date,"YYYY-MM-DDTHH:mm:ss");e.properties.event_clearance_date=a.format("MMM Do, YYYY [at] h:mma"),e.properties.event_clearance_description=e.properties.event_clearance_description.toLowerCase();var r=L.marker(e.geometry.coordinates.reverse());r.bindPopup(i(e.properties)),t.addLayer(r)}),r.addLayer(t)},function(){console.log("ERROR")})}}}]),angular.module("seahawk.crimeData",[]).factory("crimeData",["$http",function(e){return function(t){return e.get("https://data.seattle.gov/resource/3k2p-39jp.json?$where=within_circle(incident_location, 47.593307, -122.3321654, 1609.344) AND event_clearance_date > '2016-01-01T00:00:00'&$limit=5000").then(function(e){return{type:"FeatureCollection",features:_.map(e.data,function(e){return{type:"Feature",properties:_.pick(e,["event_clearance_date","event_clearance_description","general_offense_number","hundred_block_location","event_clearance_group","event_clearance_subgroup"]),geometry:{type:"Point",coordinates:[e.longitude,e.latitude]}}})}})}}]);
//# sourceMappingURL=../maps/scripts/app-c400e222a1.js.map
